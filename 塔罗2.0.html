<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¡”ç½—ç‰Œå åœ</title>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      background: linear-gradient(180deg, #1b1b2f, #162447);
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }
    .container {
      text-align: center;
      max-width: 800px;
      width: 100%;
      padding: 10px;
    }
    h1 {
      margin-bottom: 10px;
      font-size: 32px;
      letter-spacing: 2px;
      background: linear-gradient(90deg, #f5c07a, #e43f5a);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .desc {
      font-size: 16px;
      opacity: 0.9;
      margin-bottom: 30px;
      line-height: 1.5;
    }
    .mode-selector {
      margin-bottom: 25px;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }
    .mode-btn {
      padding: 12px 24px;
      border: 2px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.1);
      color: white;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
      min-width: 120px;
    }
    .mode-btn.active {
      background: #e43f5a;
      border-color: #e43f5a;
      box-shadow: 0 4px 15px rgba(228, 63, 90, 0.4);
    }
    .mode-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    .cards-container {
      margin-bottom: 30px;
    }
    .spread-name {
      font-size: 20px;
      margin-bottom: 20px;
      color: #f5c07a;
    }
    
    /* å•å¼ æŠ½ç‰Œæ¨¡å¼å¡ç‰‡æ ·å¼ */
    .single-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    .single-card {
      aspect-ratio: 2 / 3;
      background: linear-gradient(135deg, #3a3a6a, #1f4068);
      border-radius: 12px;
      cursor: pointer;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
      transform-style: preserve-3d;
      transition: transform 0.6s, opacity 0.4s, box-shadow 0.3s;
      border: 1px solid rgba(255, 255, 255, 0.1);
      perspective: 1000px;
    }
    .single-card:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
    }
    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform-style: preserve-3d;
    }
    .single-card.flipped .card-inner {
      transform: rotateY(180deg);
    }
    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-sizing: border-box;
    }
    .card-front {
      background: linear-gradient(135deg, #3a3a6a, #1f4068);
      color: rgba(255, 255, 255, 0.9);
      font-size: 14px;
      font-weight: 500;
      letter-spacing: 1px;
    }
    .card-back {
      background: linear-gradient(135deg, #f5c07a, #d18b47);
      color: #2b1b0e;
      font-weight: bold;
      font-size: 14px;
      transform: rotateY(180deg);
      text-align: center;
      line-height: 1.4;
      padding: 15px;
      word-break: break-word;
    }
    
    /* ä¸‰å¼ ç‰Œé˜µæ¨¡å¼å¡ç‰‡æ ·å¼ */
    .spread-cards {
      display: flex;
      justify-content: center;
      gap: 25px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    .spread-card {
      width: 150px;
      aspect-ratio: 2 / 3;
      position: relative;
    }
    .spread-card .card-front, .spread-card .card-back {
      font-size: 16px;
    }
    .spread-position {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.5);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 12px;
      color: white;
      z-index: 10;
    }
    
    /* é€šç”¨å¡ç‰‡æ ·å¼ */
    .card {
      background: linear-gradient(135deg, #3a3a6a, #1f4068);
      border-radius: 14px;
      cursor: pointer;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
      transform-style: preserve-3d;
      transition: transform 0.6s, opacity 0.4s;
      border: 1px solid rgba(255, 255, 255, 0.1);
      perspective: 1000px;
    }
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }
    
    /* é€‰ä¸­ç‰Œçš„é«˜äº®æ•ˆæœ */
    .card.selected .card-back {
      background: linear-gradient(135deg, #ffd166, #f5c07a);
      box-shadow: inset 0 0 20px rgba(255, 209, 102, 0.3);
      border: 2px solid #ffd166;
    }
    /* æœªé€‰ä¸­ç‰Œçš„æš—åŒ–æ•ˆæœ */
    .card:not(.selected).flipped .card-back {
      filter: brightness(0.6) contrast(0.8);
      opacity: 0.6;
    }
    
    /* ç»“æœåŒºåŸŸ */
    .result {
      margin-top: 20px;
      padding: 25px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 15px;
      font-size: 16px;
      line-height: 1.8;
      min-height: 80px;
      text-align: left;
      border-left: 3px solid #e43f5a;
      backdrop-filter: blur(10px);
    }
    .result-title {
      color: #f5c07a;
      font-size: 20px;
      margin-bottom: 15px;
      text-align: center;
    }
    .result-item {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .result-item:last-child {
      border-bottom: none;
    }
    .result-item strong {
      color: #ffd166;
      font-size: 18px;
    }
    
    /* æŒ‰é’®åŒºåŸŸ */
    .buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      flex-wrap: wrap;
    }
    button {
      padding: 14px 32px;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      letter-spacing: 1px;
      min-width: 160px;
    }
    .reset-btn {
      background: linear-gradient(90deg, #4cc9f0, #4361ee);
      color: #fff;
      box-shadow: 0 6px 15px rgba(76, 201, 240, 0.4);
    }
    .share-btn {
      background: linear-gradient(90deg, #f72585, #b5179e);
      color: #fff;
      box-shadow: 0 6px 15px rgba(247, 37, 133, 0.4);
    }
    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    }
    button:active {
      transform: translateY(-1px);
    }
    
    /* åˆ†äº«å›¾å®¹å™¨ */
    .share-image-container {
      display: none;
      margin-top: 30px;
      padding: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 15px;
      width: 100%;
      max-width: 600px;
    }
    #shareCanvas {
      max-width: 100%;
      border-radius: 10px;
      display: block;
      margin: 0 auto;
      background: white;
    }
    .download-btn {
      margin-top: 15px;
      background: linear-gradient(90deg, #4ad66d, #2a9d8f);
      width: 100%;
      max-width: 300px;
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      h1 {
        font-size: 28px;
      }
      .desc {
        font-size: 15px;
      }
      .single-cards {
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
      }
      .spread-cards {
        gap: 15px;
      }
      .spread-card {
        width: 130px;
      }
    }
    
    @media (max-width: 480px) {
      h1 {
        font-size: 24px;
      }
      .single-cards {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      .card-front, .card-back {
        font-size: 12px;
      }
      .spread-cards {
        flex-direction: column;
        align-items: center;
        gap: 20px;
      }
      .spread-card {
        width: 150px;
      }
      button {
        min-width: 140px;
        padding: 12px 24px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>å¡”ç½—ç‰Œå åœ</h1>
    <div class="desc">è¯·åœ¨å¿ƒä¸­é»˜å¿µä½ çš„é—®é¢˜ï¼Œé€‰æ‹©æŠ½ç‰Œæ¨¡å¼</div>
    
    <div class="mode-selector">
      <button class="mode-btn active" data-mode="single">å•å¼ æŠ½ç‰Œ</button>
      <button class="mode-btn" data-mode="spread">ä¸‰å¼ ç‰Œé˜µ</button>
    </div>
    
    <!-- å•å¼ æŠ½ç‰Œæ¨¡å¼ -->
    <div id="singleMode" class="cards-container">
      <div class="desc">é€‰æ‹©ä¸€å¼ å¡”ç½—ç‰Œè·å–æŒ‡å¼•</div>
      <div class="single-cards" id="singleCards">
        <!-- å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
      </div>
      <div class="result" id="singleResult"></div>
    </div>
    
    <!-- ä¸‰å¼ ç‰Œé˜µæ¨¡å¼ -->
    <div id="spreadMode" class="cards-container" style="display: none;">
      <div class="spread-name">è¿‡å» / ç°åœ¨ / æœªæ¥</div>
      <div class="desc">è¯·ä¾æ¬¡ç‚¹å‡»ä¸‰å¼ ç‰Œï¼Œä»£è¡¨è¿‡å»ã€ç°åœ¨å’Œæœªæ¥</div>
      <div class="spread-cards" id="spreadCards">
        <div class="spread-card card" data-position="past">
          <div class="spread-position">è¿‡å»</div>
          <div class="card-inner">
            <div class="card-front">ç‚¹å‡»ç¿»å¼€</div>
            <div class="card-back"></div>
          </div>
        </div>
        <div class="spread-card card" data-position="present">
          <div class="spread-position">ç°åœ¨</div>
          <div class="card-inner">
            <div class="card-front">ç‚¹å‡»ç¿»å¼€</div>
            <div class="card-back"></div>
          </div>
        </div>
        <div class="spread-card card" data-position="future">
          <div class="spread-position">æœªæ¥</div>
          <div class="card-inner">
            <div class="card-front">ç‚¹å‡»ç¿»å¼€</div>
            <div class="card-back"></div>
          </div>
        </div>
      </div>
      <div class="result" id="spreadResult"></div>
    </div>
    
    <!-- åˆ†äº«å›¾å®¹å™¨ -->
    <div class="share-image-container" id="shareImageContainer">
      <canvas id="shareCanvas" width="600" height="800"></canvas>
      <button class="download-btn" id="downloadBtn">ä¿å­˜åˆ†äº«å›¾</button>
    </div>
    
    <!-- æ§åˆ¶æŒ‰é’® -->
    <div class="buttons">
      <button class="reset-btn" id="reset">é‡æ–°æŠ½ç‰Œ</button>
      <button class="share-btn" id="share">ç”Ÿæˆåˆ†äº«å›¾</button>
    </div>
  </div>

  <script>
    // å®Œæ•´çš„å¡”ç½—ç‰Œåº“ï¼Œæ¯å¼ ç‰Œéƒ½æœ‰ç‹¬ç‰¹çš„ç‰Œæ„è§£è¯»
    const tarotCards = [
      // å¤§é˜¿å¡çº³ (22å¼ )
      { 
        name: "æ„šè€…", 
        text: "æ–°çš„å¼€å§‹ï¼Œè‡ªç”±ä¸å†’é™©ï¼Œé¡ºå…¶è‡ªç„¶ã€‚", 
        type: "major",
        interpretation: "æ„šè€…ä»£è¡¨ç€å…¨æ–°çš„æ—…ç¨‹å’Œæ— é™çš„å¯èƒ½æ€§ã€‚ä½ æ­£ç«™åœ¨äººç”Ÿçš„åå­—è·¯å£ï¼Œå‰æ–¹å……æ»¡æœªçŸ¥ã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ ä¿æŒå¼€æ”¾çš„å¿ƒæ€ï¼Œå‹‡æ•¢è¿ˆå‡ºç¬¬ä¸€æ­¥ï¼Œå³ä½¿å‰è·¯æœªçŸ¥ä¹Ÿè¦ä¿¡ä»»ç”Ÿå‘½çš„æŒ‡å¼•ã€‚"
      },
      { 
        name: "é­”æœ¯å¸ˆ", 
        text: "è¡ŒåŠ¨åŠ›ä¸æŒæ§åŠ›ï¼Œäº‹æƒ…æ­£åœ¨ä½ çš„æŒæ§ä¸­ã€‚", 
        type: "major",
        interpretation: "é­”æœ¯å¸ˆè±¡å¾ç€åˆ›é€ åŠ›å’Œæ‰§è¡ŒåŠ›ã€‚ä½ æ‹¥æœ‰å°†æƒ³æ³•å˜ä¸ºç°å®çš„æ‰€æœ‰èµ„æºã€‚è¿™å¼ ç‰Œæé†’ä½ å–„ç”¨è‡ªå·±çš„æŠ€èƒ½å’Œæ™ºæ…§ï¼Œé€šè¿‡æ˜ç¡®çš„ç›®æ ‡å’Œåšå®šçš„æ„å¿—ï¼Œå°†æ¢¦æƒ³åŒ–ä¸ºå®é™…è¡ŒåŠ¨ã€‚"
      },
      { 
        name: "å¥³ç¥­å¸", 
        text: "ç›´è§‰ã€æ½œæ„è¯†ï¼Œç­”æ¡ˆè—åœ¨å†…å¿ƒæ·±å¤„ã€‚", 
        type: "major",
        interpretation: "å¥³ç¥­å¸ä»£è¡¨ç€å†…åœ¨æ™ºæ…§å’Œç›´è§‰çš„è§‰é†’ã€‚å¤–ç•Œçš„å–§åš£å¯èƒ½è®©ä½ æ„Ÿåˆ°è¿·èŒ«ï¼Œä½†ç­”æ¡ˆå…¶å®å°±åœ¨ä½ å¿ƒä¸­ã€‚è¿™å¼ ç‰Œå»ºè®®ä½ é™å¿ƒå€¾å¬å†…åœ¨çš„å£°éŸ³ï¼Œé€šè¿‡æ¢¦å¢ƒã€å†¥æƒ³æˆ–ç‹¬å¤„æ¥è·å¾—æ·±åˆ»çš„æ´å¯Ÿã€‚"
      },
      { 
        name: "çš‡å", 
        text: "æ»‹å…»ã€å…³æ€€ï¼Œå…³ç³»æˆ–äº‹ä¸šæ­£åœ¨æˆé•¿ã€‚", 
        type: "major",
        interpretation: "çš‡åè±¡å¾ç€ä¸°é¥¶ã€åˆ›é€ åŠ›å’Œæ¯æ€§çš„æ»‹å…»åŠ›é‡ã€‚æ— è®ºæ˜¯äº‹ä¸šã€å…³ç³»è¿˜æ˜¯ä¸ªäººæˆé•¿ï¼Œç°åœ¨éƒ½æ˜¯åŸ¹è‚²å’Œå‘å±•çš„æ—¶æœŸã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ æ¸©æŸ”å¯¹å¾…è‡ªå·±å’Œä»–äººï¼Œç”¨çˆ±å¿ƒå’Œè€å¿ƒåŸ¹è‚²é‡è¦çš„äº‹ç‰©ã€‚"
      },
      { 
        name: "çš‡å¸", 
        text: "ç§©åºã€è´£ä»»ï¼Œå»ºç«‹ç¨³å®šçš„åŸºç¡€ã€‚", 
        type: "major",
        interpretation: "çš‡å¸ä»£è¡¨ç€æƒå¨ã€ç»“æ„å’Œç¨³å®šçš„åŸºç¡€ã€‚ä½ éœ€è¦å»ºç«‹æ˜ç¡®çš„è§„åˆ™å’Œç•Œé™ï¼Œæ‰¿æ‹…èµ·é¢†å¯¼çš„è´£ä»»ã€‚è¿™å¼ ç‰Œæé†’ä½ é€šè¿‡è‡ªå¾‹ã€è®¡åˆ’å’Œåšå®šçš„æ„å¿—æ¥åˆ›é€ æŒä¹…çš„å®‰å…¨æ„Ÿå’Œæˆå°±ã€‚"
      },
      { 
        name: "æ•™çš‡", 
        text: "ä¼ ç»Ÿã€æŒ‡å¼•ï¼Œå¯»æ±‚æƒå¨æˆ–ä¼ ç»Ÿæ™ºæ…§ã€‚", 
        type: "major",
        interpretation: "æ•™çš‡è±¡å¾ç€ä¼ ç»Ÿã€æ•™è‚²å’Œç²¾ç¥æŒ‡å¼•ã€‚ä½ å¯èƒ½éœ€è¦å¯¼å¸ˆã€ä¼ ç»Ÿæ™ºæ…§æˆ–å†…å¿ƒé“å¾·å‡†åˆ™çš„æŒ‡å¼•ã€‚è¿™å¼ ç‰Œå»ºè®®ä½ å¯»æ±‚å€¼å¾—ä¿¡èµ–çš„æŒ‡å¯¼ï¼ŒåŒæ—¶ä¹Ÿè¦å‘å±•è‡ªå·±å†…åœ¨çš„é“å¾·å’Œä¿¡ä»°ä½“ç³»ã€‚"
      },
      { 
        name: "æ‹äºº", 
        text: "é€‰æ‹©ä¸å…³ç³»ï¼Œè·Ÿéšå†…å¿ƒçš„çœŸå®æƒ³æ³•ã€‚", 
        type: "major",
        interpretation: "æ‹äººä»£è¡¨ç€é‡è¦çš„é€‰æ‹©ã€å…³ç³»çš„å’Œè°ä¸ä»·å€¼è§‚çš„æ•´åˆã€‚ä½ é¢ä¸´ç€é‡å¤§çš„å†³å®šï¼Œéœ€è¦è†å¬å†…å¿ƒçš„çœŸå®å£°éŸ³ã€‚è¿™å¼ ç‰Œæé†’ä½ ï¼ŒçœŸæ­£çš„é€‰æ‹©æºäºçˆ±ä¸çœŸå®çš„è‡ªæˆ‘ï¼Œè€Œéå¤–åœ¨çš„æœŸå¾…ã€‚"
      },
      { 
        name: "æˆ˜è½¦", 
        text: "å‰è¿›ä¸èƒœåˆ©ï¼ŒåšæŒå°†å¸¦æ¥æˆæœã€‚", 
        type: "major",
        interpretation: "æˆ˜è½¦è±¡å¾ç€æ„å¿—åŠ›ã€èƒœåˆ©å’Œå‰è¿›çš„åŠ¨åŠ›ã€‚ä½ æ­£æœç€ç›®æ ‡å¿«é€Ÿå‰è¿›ï¼Œä½†éœ€è¦å¹³è¡¡å¯¹ç«‹çš„åŠ›é‡ã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ ä¿æŒä¸“æ³¨å’Œå†³å¿ƒï¼Œå³ä½¿é¢å¯¹æŒ‘æˆ˜ä¹Ÿè¦åšæŒå‰è¡Œï¼Œèƒœåˆ©å°±åœ¨å‰æ–¹ã€‚"
      },
      { 
        name: "åŠ›é‡", 
        text: "æ¸©æŸ”çš„åŠ›é‡ï¼Œè€å¿ƒä¸å‹‡æ°”å¹¶å­˜ã€‚", 
        type: "major",
        interpretation: "åŠ›é‡ç‰Œä»£è¡¨ç€ä»¥æŸ”å…‹åˆšçš„æ™ºæ…§ã€å†…åœ¨å‹‡æ°”å’ŒåŒæƒ…å¿ƒã€‚çœŸæ­£çš„åŠ›é‡ä¸åœ¨äºæ§åˆ¶ï¼Œè€Œåœ¨äºç†è§£ã€æ¥çº³å’Œå¼•å¯¼ã€‚è¿™å¼ ç‰Œæé†’ä½ ï¼Œé€šè¿‡æ¸©æŸ”ã€è€å¿ƒå’Œçˆ±çš„åŠ›é‡ï¼Œå¯ä»¥å…‹æœä»»ä½•å›°éš¾ã€‚"
      },
      { 
        name: "éšè€…", 
        text: "ç‹¬å¤„ä¸æ€è€ƒï¼Œå¯»æ‰¾å†…åœ¨çš„æŒ‡å¼•ã€‚", 
        type: "major",
        interpretation: "éšè€…è±¡å¾ç€å†…çœã€æ™ºæ…§å’Œå­¤ç‹¬ä¸­çš„å¯ç¤ºã€‚ç°åœ¨æ˜¯é€€ä¸€æ­¥å®¡è§†ç”Ÿæ´»å’Œå¯»æ±‚å†…åœ¨çœŸç†çš„æ—¶æœŸã€‚è¿™å¼ ç‰Œå»ºè®®ä½ èŠ±æ—¶é—´ç‹¬å¤„ã€åæ€ï¼Œä»å¤–åœ¨çš„å–§åš£è½¬å‘å†…åœ¨çš„æ™ºæ…§ä¹‹å…‰ã€‚"
      },
      { 
        name: "å‘½è¿ä¹‹è½®", 
        text: "å‘½è¿çš„è½¬æŠ˜ï¼Œå˜åŒ–æ˜¯ä¸å¯é¿å…çš„ã€‚", 
        type: "major",
        interpretation: "å‘½è¿ä¹‹è½®ä»£è¡¨ç€å‘½è¿çš„å¾ªç¯ã€è½¬æŠ˜å’Œä¸å¯é¿å…çš„å˜åŒ–ã€‚ç”Ÿå‘½ä¸­æ—¢æœ‰ä¸Šå‡ä¹Ÿæœ‰ä¸‹é™çš„å‘¨æœŸã€‚è¿™å¼ ç‰Œæé†’ä½ ï¼Œå˜åŒ–æ˜¯è‡ªç„¶æ³•åˆ™ï¼Œè¦ä»¥å¼€æ”¾çš„å¿ƒæ€æ¥å—ç”Ÿå‘½æµè½¬ï¼Œä»ä¸­å­¦ä¹ å’Œæˆé•¿ã€‚"
      },
      { 
        name: "æ­£ä¹‰", 
        text: "å…¬å¹³ã€å¹³è¡¡ï¼Œå†³å®šå¸¦æ¥ç»“æœã€‚", 
        type: "major",
        interpretation: "æ­£ä¹‰è±¡å¾ç€å…¬å¹³ã€å› æœå¾‹å’Œé‡è¦çš„å†³å®šã€‚æ¯ä¸€ä¸ªè¡ŒåŠ¨éƒ½ä¼šå¸¦æ¥ç›¸åº”çš„ç»“æœã€‚è¿™å¼ ç‰Œæé†’ä½ å®¢è§‚è¯„ä¼°å±€åŠ¿ï¼Œä¸ºè‡ªå·±çš„é€‰æ‹©æ‰¿æ‹…è´£ä»»ï¼Œå¯»æ±‚å¹³è¡¡ä¸å’Œè°ï¼Œè®©çœŸç†å’Œå…¬æ­£æŒ‡å¼•ä½ çš„é“è·¯ã€‚"
      },
      { 
        name: "å€’åŠäºº", 
        text: "æ¢ä½æ€è€ƒï¼Œç‰ºç‰²å¸¦æ¥æ–°çš„è§†è§’ã€‚", 
        type: "major",
        interpretation: "å€’åŠäººä»£è¡¨ç€è‡ªæ„¿çš„ç‰ºç‰²ã€ä¸åŒçš„è§†è§’å’Œç­‰å¾…çš„æ™ºæ…§ã€‚æš‚æ—¶çš„åœé¡¿æˆ–ç‰ºç‰²å¯èƒ½å¸¦æ¥æ›´æ·±å±‚çš„ç†è§£ã€‚è¿™å¼ ç‰Œå»ºè®®ä½ æ¢ä¸ªè§’åº¦çœ‹é—®é¢˜ï¼Œåœ¨ç­‰å¾…ä¸­æ”¶è·æ´è§ï¼Œè¡¨é¢çš„æŸå¤±å¯èƒ½æ˜¯å†…åœ¨çš„æ”¶è·ã€‚"
      },
      { 
        name: "æ­»ç¥", 
        text: "ç»“æŸä¸æ–°ç”Ÿï¼Œæ”¾ä¸‹è¿‡å»è¿æ¥æœªæ¥ã€‚", 
        type: "major",
        interpretation: "æ­»ç¥è±¡å¾ç€ç»“æŸã€è½¬å˜å’Œé‡ç”Ÿã€‚æ—§çš„äº‹ç‰©éœ€è¦æ”¾ä¸‹ï¼Œæ‰èƒ½ä¸ºæ–°çš„å¼€å§‹è…¾å‡ºç©ºé—´ã€‚è¿™å¼ ç‰Œæé†’ä½ ï¼Œç»“æŸä¸æ˜¯ç»ˆç‚¹è€Œæ˜¯æ–°ç”Ÿçš„å¼€å§‹ï¼Œå‹‡æ•¢å‘Šåˆ«è¿‡å»ï¼Œè¿æ¥ç”Ÿå‘½çš„ä¸‹ä¸€ç¯‡ç« ã€‚"
      },
      { 
        name: "èŠ‚åˆ¶", 
        text: "è°ƒå’Œã€ä¸­åº¸ï¼Œæ‰¾åˆ°å¹³è¡¡ç‚¹ã€‚", 
        type: "major",
        interpretation: "èŠ‚åˆ¶ä»£è¡¨ç€å¹³è¡¡ã€è°ƒå’Œä¸é€‚åº¦çš„æ™ºæ…§ã€‚å¯¹ç«‹çš„åŠ›é‡éœ€è¦èåˆï¼Œæç«¯çš„å€¾å‘éœ€è¦è°ƒèŠ‚ã€‚è¿™å¼ ç‰Œå»ºè®®ä½ å¯»æ±‚ä¸­åº¸ä¹‹é“ï¼Œæ•´åˆä¸åŒçš„å…ƒç´ ï¼Œåœ¨è€å¿ƒå’Œå®è·µä¸­æ‰¾åˆ°å’Œè°ä¸å¹³è¡¡ã€‚"
      },
      { 
        name: "æ¶é­”", 
        text: "æ¬²æœ›ä¸æŸç¼šï¼Œçœ‹æ¸…è¡¨è±¡ä¸‹çš„çœŸç›¸ã€‚", 
        type: "major",
        interpretation: "æ¶é­”è±¡å¾ç€æŸç¼šã€ç‰©è´¨æ¬²æœ›å’Œè¡¨é¢çš„è¯±æƒ‘ã€‚ä½ å¯èƒ½æ„Ÿåˆ°è¢«æŸäº›ä¹ æƒ¯ã€å…³ç³»æˆ–ç‰©è´¨è¿½æ±‚æ‰€å›°ã€‚è¿™å¼ ç‰Œæé†’ä½ å®¡è§†æŸç¼šçš„æœ¬è´¨ï¼ŒçœŸæ­£çš„è‡ªç”±æºäºçœ‹æ¸…çœŸç›¸å¹¶åšå‡ºæœ‰æ„è¯†çš„é€‰æ‹©ã€‚"
      },
      { 
        name: "é«˜å¡”", 
        text: "çªç„¶çš„å˜åŒ–ï¼Œæ‰“ç ´æ—§æœ‰ç»“æ„ã€‚", 
        type: "major",
        interpretation: "é«˜å¡”ä»£è¡¨ç€çªå¦‚å…¶æ¥çš„å˜åŒ–ã€å¯ç¤ºå’Œæ—§ç»“æ„çš„å´©å¡Œã€‚çœ‹ä¼¼ç ´åæ€§çš„äº‹ä»¶å¯èƒ½å¸¦æ¥å¿…è¦çš„è§‰é†’ã€‚è¿™å¼ ç‰Œæé†’ä½ ï¼Œæœ‰æ—¶æ—§çš„åŸºç¡€å¿…é¡»æ‰“ç ´ï¼Œæ‰èƒ½å»ºç«‹æ›´çœŸå®ã€æ›´ç¨³å›ºçš„æ–°ç»“æ„ã€‚"
      },
      { 
        name: "æ˜Ÿæ˜Ÿ", 
        text: "å¸Œæœ›ã€çµæ„Ÿï¼Œåœ¨é»‘æš—ä¸­å¯»æ‰¾å…‰æ˜ã€‚", 
        type: "major",
        interpretation: "æ˜Ÿæ˜Ÿè±¡å¾ç€å¸Œæœ›ã€çµæ„Ÿå’Œç²¾ç¥æŒ‡å¼•ã€‚å³ä½¿åœ¨å›°éš¾æ—¶æœŸï¼Œå¸Œæœ›ä¹‹å…‰ä¾ç„¶é—ªè€€ã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ ä¿æŒä¿¡å¿µï¼Œè¿½éšå†…å¿ƒçš„çµæ„Ÿï¼Œç›¸ä¿¡å®‡å®™çš„æ”¯æŒï¼Œä½ çš„æ¢¦æƒ³æœ‰å®ç°çš„å¯èƒ½ã€‚"
      },
      { 
        name: "æœˆäº®", 
        text: "æ½œæ„è¯†ã€æ¢¦å¢ƒï¼Œé¢å¯¹å†…å¿ƒçš„ææƒ§ã€‚", 
        type: "major",
        interpretation: "æœˆäº®ä»£è¡¨ç€æ½œæ„è¯†ã€å¹»è§‰å’Œéœ€è¦é¢å¯¹çš„å†…åœ¨ææƒ§ã€‚äº‹ç‰©çš„è¡¨è±¡å¯èƒ½æ¨¡ç³Šä¸æ¸…ï¼Œéœ€è¦é€è¿‡è¿·é›¾çœ‹æ¸…çœŸç›¸ã€‚è¿™å¼ ç‰Œå»ºè®®ä½ ä¿¡ä»»ç›´è§‰ï¼Œæ¢ç´¢æ½œæ„è¯†ï¼Œå‹‡æ•¢é¢å¯¹éšè—çš„ææƒ§å’Œæ¬²æœ›ã€‚"
      },
      { 
        name: "å¤ªé˜³", 
        text: "æˆåŠŸã€å¿«ä¹ï¼Œå……æ»¡æ´»åŠ›å’Œä¿¡å¿ƒã€‚", 
        type: "major",
        interpretation: "å¤ªé˜³è±¡å¾ç€æˆåŠŸã€å¿«ä¹ã€æ´»åŠ›å’Œä¿¡å¿ƒã€‚å…‰æ˜é©±æ•£é»‘æš—ï¼ŒçœŸç†æ˜¾ç°ã€‚è¿™å¼ ç‰Œé¢„ç¤ºç€ä¸€ä¸ªå……æ»¡æ´»åŠ›ã€ç§¯æä¹è§‚çš„æ—¶æœŸï¼Œé¼“åŠ±ä½ äº«å—ç”Ÿæ´»çš„ç¾å¥½ï¼Œä»¥å¼€æ”¾çš„å¿ƒèƒ¸è¿æ¥æˆåŠŸå’Œå¿«ä¹ã€‚"
      },
      { 
        name: "å®¡åˆ¤", 
        text: "è§‰é†’ã€é‡ç”Ÿï¼Œå¬å–å†…å¿ƒçš„å¬å”¤ã€‚", 
        type: "major",
        interpretation: "å®¡åˆ¤ä»£è¡¨ç€è§‰é†’ã€é‡ç”Ÿå’Œå†…åœ¨çš„å¬å”¤ã€‚ç°åœ¨æ˜¯å›é¡¾è¿‡å»ã€è¯„ä¼°ç°åœ¨ã€è¿æ¥æ–°ç”Ÿçš„æ—¶åˆ»ã€‚è¿™å¼ ç‰Œæé†’ä½ å¬ä»å†…å¿ƒçš„å¬å”¤ï¼Œæ”¾ä¸‹è¿‡å»çš„è´Ÿæ‹…ï¼Œä»¥æ–°çš„æ„è¯†å’Œç†è§£è¿æ¥ç”Ÿå‘½çš„ä¸‹ä¸€é˜¶æ®µã€‚"
      },
      { 
        name: "ä¸–ç•Œ", 
        text: "åœ†æ»¡ã€å®Œæˆï¼Œè¾¾æˆç›®æ ‡è·å¾—æˆåŠŸã€‚", 
        type: "major",
        interpretation: "ä¸–ç•Œè±¡å¾ç€åœ†æ»¡ã€æˆå°±å’Œæ—…è¡Œçš„å®Œæˆã€‚ä¸€ä¸ªé‡è¦çš„å‘¨æœŸå³å°†ç»“æŸï¼Œä½ å³å°†æ”¶è·åŠªåŠ›çš„æˆæœã€‚è¿™å¼ ç‰Œé¢„ç¤ºç€ä¸€ä¸ªé˜¶æ®µçš„åœ†æ»¡å®Œæˆï¼Œé¼“åŠ±ä½ åº†ç¥æˆå°±ï¼ŒåŒæ—¶ä¸ºæ–°çš„æ—…ç¨‹åšå¥½å‡†å¤‡ã€‚"
      },
      
      // ç²¾é€‰çš„å°é˜¿å¡çº³ (10å¼ )
      { 
        name: "æƒæ–ç‹ç‰Œ", 
        text: "æ–°çš„è¡ŒåŠ¨ã€èƒ½é‡ã€åˆ›æ„é¡¹ç›®å¼€å§‹ã€‚", 
        type: "wand",
        interpretation: "æƒæ–ç‹ç‰Œä»£è¡¨ç€æ–°çš„å¼€å§‹ã€åˆ›æ„èƒ½é‡å’Œè¡ŒåŠ¨çš„ç«èŠ±ã€‚ç°åœ¨æ˜¯å¯åŠ¨æ–°é¡¹ç›®ã€è¿½æ±‚æ¿€æƒ…æˆ–é‡‡å–ä¸»åŠ¨çš„ç†æƒ³æ—¶æœºã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ æŠ“ä½æœºä¼šï¼Œç”¨çƒ­æƒ…å’Œå†³å¿ƒç‚¹ç‡ƒæ–°çš„æ—…ç¨‹ã€‚"
      },
      { 
        name: "åœ£æ¯ç‹ç‰Œ", 
        text: "æ–°çš„æƒ…æ„Ÿå¼€å§‹ï¼Œçˆ±çš„æœºä¼šã€‚", 
        type: "cup",
        interpretation: "åœ£æ¯ç‹ç‰Œè±¡å¾ç€æ–°çš„æƒ…æ„Ÿè¿æ¥ã€çˆ±çš„å¯èƒ½æ€§å’Œæƒ…æ„Ÿçš„ä¸°å¯Œã€‚å¿ƒçš„å¤§é—¨æ­£åœ¨æ‰“å¼€ï¼Œæ— è®ºæ˜¯æ–°çš„å…³ç³»è¿˜æ˜¯å¯¹ç°æœ‰å…³ç³»çš„æ·±åŒ–ã€‚è¿™å¼ ç‰Œæé†’ä½ æ•å¼€å¿ƒæ‰‰ï¼Œæ¥å—æƒ…æ„Ÿçš„æ»‹å…»å’Œç»™äºˆã€‚"
      },
      { 
        name: "å®å‰‘ç‹ç‰Œ", 
        text: "æ–°æƒ³æ³•ï¼Œæ¸…æ™°æ€ç»´ï¼Œçªç ´ã€‚", 
        type: "sword",
        interpretation: "å®å‰‘ç‹ç‰Œä»£è¡¨ç€æ€æƒ³çš„çªç ´ã€æ¸…æ™°åº¦å’ŒçœŸç†çš„æ˜¾ç°ã€‚ä¸€ä¸ªé‡è¦çš„æ´è§æˆ–å†³å®šå³å°†å½¢æˆã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ è¿ç”¨æ¸…æ™°çš„æ€ç»´ï¼Œåˆ‡æ–­å›°æƒ‘ï¼Œè¿½æ±‚çœŸç†ï¼Œç”¨æ™ºæ…§æŒ‡å¼•è¡ŒåŠ¨ã€‚"
      },
      { 
        name: "æ˜Ÿå¸ç‹ç‰Œ", 
        text: "æ–°æœºä¼šï¼Œç‰©è´¨å¼€å§‹ï¼Œè´¢åŠ¡ç¨³å®šã€‚", 
        type: "pentacle",
        interpretation: "æ˜Ÿå¸ç‹ç‰Œè±¡å¾ç€ç‰©è´¨ä¸Šçš„æ–°å¼€å§‹ã€è´¢åŠ¡æœºä¼šå’Œå®é™…çš„æˆåŠŸã€‚ä¸€ä¸ªåˆ‡å®å¯è¡Œçš„è®¡åˆ’æˆ–ç‰©è´¨æ”¶è·æ­£åœ¨å½¢æˆã€‚è¿™å¼ ç‰Œæé†’ä½ å…³æ³¨å®é™…çš„æ­¥éª¤ï¼ŒæŠ•èµ„äºæœ‰å½¢çš„ã€å¯æŒç»­çš„æˆé•¿ã€‚"
      },
      { 
        name: "åœ£æ¯å", 
        text: "å®¶åº­å¹¸ç¦ï¼Œæƒ…æ„Ÿåœ†æ»¡ã€‚", 
        type: "cup",
        interpretation: "åœ£æ¯åä»£è¡¨ç€æƒ…æ„Ÿä¸Šçš„åœ†æ»¡ã€å®¶åº­å’Œè°å’Œæ·±æ·±çš„æ»¡è¶³æ„Ÿã€‚ä½ åœ¨å…³ç³»ä¸­æ‰¾åˆ°å¿«ä¹å’Œå½’å±æ„Ÿã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ çæƒœä¸æ‰€çˆ±ä¹‹äººçš„è¿æ¥ï¼Œåˆ›é€ å…±äº«çš„å¿«ä¹å’Œæƒ…æ„Ÿå®‰å…¨æ„Ÿã€‚"
      },
      { 
        name: "æ˜Ÿå¸å", 
        text: "å®¶åº­è´¢å¯Œï¼Œä¸–ä»£ä¼ æ‰¿ã€‚", 
        type: "pentacle",
        interpretation: "æ˜Ÿå¸åè±¡å¾ç€ç‰©è´¨çš„ä¸°ç››ã€å®¶åº­é—äº§å’Œé•¿æœŸçš„ç¨³å®šã€‚è´¢åŠ¡ä¸Šçš„æˆåŠŸå¸¦æ¥å®‰å…¨æ„Ÿå’Œä¼ æ‰¿çš„å¯èƒ½ã€‚è¿™å¼ ç‰Œæé†’ä½ å¹³è¡¡ç‰©è´¨ä¸æƒ…æ„Ÿï¼Œç”¨èµ„æºæ”¯æŒå®¶åº­å’Œæœªæ¥ä¸–ä»£ã€‚"
      },
      { 
        name: "å®å‰‘å", 
        text: "ç»“æŸã€å›°å¢ƒï¼Œé»æ˜å‰æœ€é»‘æš—ã€‚", 
        type: "sword",
        interpretation: "å®å‰‘åä»£è¡¨ç€ç—›è‹¦çš„ç»“æŸã€å›°éš¾çš„é¡¶ç‚¹å’Œå¿…è¦çš„é‡Šæ”¾ã€‚ä¸€æ®µè‰°éš¾çš„æ—¶æœŸå³å°†è¿‡å»ï¼Œé»æ˜å‰çš„é»‘æš—æœ€æ·±æ²‰ã€‚è¿™å¼ ç‰Œæé†’ä½ ï¼Œç»“æŸå¸¦æ¥æ–°çš„å¼€å§‹ï¼Œæ”¾ä¸‹ç—›è‹¦çš„è´Ÿæ‹…ï¼Œä¸ºé‡ç”Ÿåšå¥½å‡†å¤‡ã€‚"
      },
      { 
        name: "æƒæ–å", 
        text: "è´Ÿæ‹…ã€è´£ä»»ï¼Œéœ€è¦å‡è½»å‹åŠ›ã€‚", 
        type: "wand",
        interpretation: "æƒæ–åè±¡å¾ç€æ²‰é‡çš„è´Ÿæ‹…ã€è¿‡å¤šçš„è´£ä»»å’Œéœ€è¦å‡è½»çš„å‹åŠ›ã€‚ä½ å¯èƒ½æ‰¿æ‹…äº†è¶…å‡ºèƒ½åŠ›èŒƒå›´çš„è´£ä»»ã€‚è¿™å¼ ç‰Œå»ºè®®ä½ é‡æ–°è¯„ä¼°ä¼˜å…ˆäº‹é¡¹ï¼Œå­¦ä¼šå§”æ´¾æˆ–æ”¾ä¸‹ä¸å¿…è¦çš„è´Ÿæ‹…ï¼Œé‡è·è‡ªç”±ã€‚"
      },
      { 
        name: "åœ£æ¯éª‘å£«", 
        text: "æµªæ¼«æè®®ï¼Œæƒ…æ„Ÿè¿½æ±‚è€…ã€‚", 
        type: "cup",
        interpretation: "åœ£æ¯éª‘å£«ä»£è¡¨ç€æµªæ¼«çš„æè®®ã€æƒ…æ„Ÿçš„è¿½æ±‚å’Œç†æƒ³çš„è¿½éšè€…ã€‚çˆ±ä¸ç¾åœ¨å¬å”¤ï¼Œéœ€è¦å‹‡æ°”è¿½éšå†…å¿ƒã€‚è¿™å¼ ç‰Œé¼“åŠ±ä½ å¸¦ç€çœŸè¯šå’Œå¼€æ”¾çš„å¿ƒè¿½æ±‚æƒ…æ„Ÿç›®æ ‡ï¼Œæˆ–æ˜¯æ¥å—ä»–äººçœŸæŒšçš„æƒ…æ„Ÿè¡¨è¾¾ã€‚"
      },
      { 
        name: "æ˜Ÿå¸å›½ç‹", 
        text: "æˆåŠŸã€è´¢å¯Œï¼Œç²¾æ˜çš„å•†ä¸šé¢†è¢–ã€‚", 
        type: "pentacle",
        interpretation: "æ˜Ÿå¸å›½ç‹è±¡å¾ç€ç‰©è´¨ä¸Šçš„æˆåŠŸã€ç²¾æ˜çš„ç®¡ç†å’ŒåŠ¡å®çš„é¢†å¯¼ã€‚é€šè¿‡æ™ºæ…§ã€åŠªåŠ›å’Œè´£ä»»æ„Ÿè·å¾—ç¨³å®šå’Œä¸°ç››ã€‚è¿™å¼ ç‰Œæé†’ä½ ä»¥åŠ¡å®ã€å¯é çš„æ–¹å¼ç®¡ç†èµ„æºï¼Œå»ºç«‹æŒä¹…çš„æˆåŠŸåŸºç¡€ã€‚"
      }
    ];

    // DOMå…ƒç´ 
    const modeBtns = document.querySelectorAll('.mode-btn');
    const singleModeDiv = document.getElementById('singleMode');
    const spreadModeDiv = document.getElementById('spreadMode');
    const singleCardsDiv = document.getElementById('singleCards');
    const spreadCards = document.querySelectorAll('.spread-card');
    const singleResultDiv = document.getElementById('singleResult');
    const spreadResultDiv = document.getElementById('spreadResult');
    const resetBtn = document.getElementById('reset');
    const shareBtn = document.getElementById('share');
    const shareImageContainer = document.getElementById('shareImageContainer');
    const shareCanvas = document.getElementById('shareCanvas');
    const downloadBtn = document.getElementById('downloadBtn');
    const ctx = shareCanvas.getContext('2d');

    // å…¨å±€çŠ¶æ€
    let currentMode = 'single';
    let selectedSingleCardIndex = -1;
    let spreadSelections = {
      past: null,
      present: null,
      future: null
    };
    let spreadCount = 0;

    // è·å–éšæœºå¡”ç½—ç‰Œï¼ˆä¸é‡å¤ï¼‰
    function getRandomTarotCards(count) {
      const shuffled = [...tarotCards].sort(() => Math.random() - 0.5);
      return shuffled.slice(0, count);
    }

    // è·å–ç‰Œç»„ç±»å‹çš„ä¸­æ–‡åç§°
    function getCardTypeChinese(type) {
      const types = {
        'major': 'å¤§é˜¿å¡çº³',
        'wand': 'æƒæ–ç‰Œç»„',
        'cup': 'åœ£æ¯ç‰Œç»„',
        'sword': 'å®å‰‘ç‰Œç»„',
        'pentacle': 'æ˜Ÿå¸ç‰Œç»„'
      };
      return types[type] || type;
    }

    // æ ¹æ®ä¸‰å¼ ç‰Œç”Ÿæˆç‹¬ç‰¹çš„æ•´ä½“è§£è¯»
    function generateSpreadInterpretation(past, present, future) {
      const interpretations = [
        `è¿™ä¸‰å¼ ç‰Œæ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„æ—¶é—´å™äº‹ï¼š${past.name}ä»£è¡¨è¿‡å»çš„ç»å†ä¸ºä½ ç§¯ç´¯äº†${getInterpretationTheme(past.type)}ï¼›${present.name}æç¤ºä½ ç°åœ¨éœ€è¦å…³æ³¨${getInterpretationTheme(present.type)}ï¼›${future.name}åˆ™é¢„ç¤ºæœªæ¥å¯èƒ½å‡ºç°çš„${getInterpretationTheme(future.type)}ã€‚`,
        `æ—¶é—´çº¿ç´¢æ¸…æ™°å¯è§ï¼šè¿‡å»çš„${past.name}ç•™ä¸‹äº†æ·±åˆ»çš„å°è®°ï¼Œç°åœ¨çš„${present.name}è¦æ±‚ä½ é‡‡å–è¡ŒåŠ¨ï¼Œè€Œæœªæ¥çš„${future.name}åˆ™å±•ç¤ºäº†ä½ å¯èƒ½åˆ°è¾¾çš„æ–¹å‘ã€‚ä¸‰è€…ç›¸äº’å…³è”ï¼Œæ„æˆäº†ä½ äººç”Ÿçš„è¿ç»­ç¯‡ç« ã€‚`,
        `ä»${past.name}åˆ°${present.name}å†åˆ°${future.name}ï¼Œè¿™ä¸‰å¼ ç‰Œæ­ç¤ºäº†ä¸€ä¸ªæˆé•¿çš„å¼§çº¿ï¼šä½ ä»è¿‡å»çš„ç»éªŒä¸­å­¦ä¹ ï¼Œåœ¨ç°åœ¨çš„æŒ‘æˆ˜ä¸­æˆç†Ÿï¼Œå¹¶æœç€æœªæ¥çš„å¯èƒ½æ€§å‰è¿›ã€‚æ¯ä¸€é˜¶æ®µéƒ½æ˜¯ä¸‹ä¸€é˜¶æ®µçš„åŸºç¡€ã€‚`,
        `è¿‡å»ã€ç°åœ¨ã€æœªæ¥åœ¨æ­¤äº¤æ±‡ï¼š${past.name}å¸¦æ¥çš„å½±å“ä»åœ¨å›è¡ï¼Œ${present.name}è¦æ±‚ä½ åšå‡ºå…³é”®å†³å®šï¼Œè€Œ${future.name}åˆ™ä¸ºä½ å±•ç¤ºäº†æ½œåœ¨çš„ç»“æœã€‚ä¸‰è€…å…±åŒæç»˜äº†ä½ äººç”Ÿé“è·¯çš„å®Œæ•´å›¾æ™¯ã€‚`,
        `è¿™ä¸‰å¼ ç‰Œå½¢æˆäº†ä¸€ä¸ªåŠ¨æ€çš„å¹³è¡¡ï¼š${past.name}ä»£è¡¨å·²å®Œæˆçš„è¯¾é¢˜ï¼Œ${present.name}æ˜¯å½“å‰éœ€è¦é¢å¯¹çš„æŒ‘æˆ˜ï¼Œ${future.name}åˆ™æ˜¯å³å°†å±•å¼€çš„å¯èƒ½æ€§ã€‚ç†è§£å®ƒä»¬ä¹‹é—´çš„è”ç³»å°†å¸®åŠ©ä½ æ›´å¥½åœ°å¯¼èˆªäººç”Ÿã€‚`
      ];
      
      // æ ¹æ®ç‰Œçš„ç±»å‹ç»„åˆé€‰æ‹©æœ€åˆé€‚çš„è§£è¯»
      const pastTheme = getInterpretationTheme(past.type);
      const presentTheme = getInterpretationTheme(present.type);
      const futureTheme = getInterpretationTheme(future.type);
      
      // å¦‚æœä¸‰å¼ ç‰Œéƒ½æ˜¯å¤§é˜¿å¡çº³ï¼Œä½¿ç”¨ç‰¹æ®Šçš„è§£è¯»
      if (past.type === 'major' && present.type === 'major' && future.type === 'major') {
        return `è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰Œé˜µï¼ä¸‰å¼ éƒ½æ˜¯å¤§é˜¿å¡çº³ç‰Œï¼ˆ${past.name}ã€${present.name}ã€${future.name}ï¼‰ï¼Œè¡¨æ˜ä½ æ­£ç»å†ä¸€ä¸ªæ·±åˆ»çš„ç”Ÿå‘½è½¬æŠ˜æœŸã€‚è¿™ä¸‰å¼ ç‰Œå…±åŒè®²è¿°äº†ä¸€ä¸ªå…³äºå‘½è¿ã€çµé­‚æˆé•¿å’Œé‡å¤§è½¬å˜çš„æ•…äº‹ï¼Œæé†’ä½ å…³æ³¨ç”Ÿå‘½ä¸­æ›´æ·±å±‚çš„æ„ä¹‰å’Œç›®çš„ã€‚`;
      }
      
      // éšæœºé€‰æ‹©ä¸€ä¸ªè§£è¯»
      return interpretations[Math.floor(Math.random() * interpretations.length)];
    }

    // æ ¹æ®ç‰Œçš„ç±»å‹è·å–è§£è¯»ä¸»é¢˜
    function getInterpretationTheme(type) {
      switch(type) {
        case 'major': return 'é‡è¦çš„ç”Ÿå‘½è¯¾é¢˜';
        case 'wand': return 'è¡ŒåŠ¨ä¸åˆ›é€ åŠ›';
        case 'cup': return 'æƒ…æ„Ÿä¸å…³ç³»';
        case 'sword': return 'æ€æƒ³ä¸æ²Ÿé€š';
        case 'pentacle': return 'ç‰©è´¨ä¸å®é™…';
        default: return 'ä¸ªäººæˆé•¿';
      }
    }

    // åˆå§‹åŒ–å•å¼ æŠ½ç‰Œæ¨¡å¼
    function initSingleMode() {
      singleCardsDiv.innerHTML = '';
      selectedSingleCardIndex = -1;
      singleResultDiv.innerHTML = '';
      
      // åˆ›å»º12å¼ å¡ç‰‡
      const cards = getRandomTarotCards(12);
      
      cards.forEach((card, index) => {
        const cardElement = document.createElement('div');
        cardElement.className = 'single-card card';
        cardElement.dataset.index = index;
        
        cardElement.innerHTML = `
          <div class="card-inner">
            <div class="card-front">ç‚¹å‡»æŠ½ç‰Œ</div>
            <div class="card-back"></div>
          </div>
        `;
        
        const backElement = cardElement.querySelector('.card-back');
        backElement.textContent = card.name;
        backElement.dataset.text = card.text;
        backElement.dataset.interpretation = card.interpretation;
        backElement.dataset.type = card.type;
        
        cardElement.addEventListener('click', () => {
          if (selectedSingleCardIndex !== -1) return;
          
          selectedSingleCardIndex = index;
          cardElement.classList.add('selected');
          
          // ç¿»è½¬æ‰€æœ‰ç‰Œ
          document.querySelectorAll('.single-card').forEach((c, i) => {
            c.classList.add('flipped');
            if (parseInt(c.dataset.index) !== index) {
              c.style.opacity = '0.6';
            }
          });
          
          // æ˜¾ç¤ºç»“æœ
          const cardTypeText = getCardTypeChinese(card.type);
          singleResultDiv.innerHTML = `
            <div class="result-title">ğŸ”® ä½ çš„å¡”ç½—ç‰ŒæŒ‡å¼•</div>
            <div class="result-item">
              <strong>${card.name}</strong> (${cardTypeText})<br>
              ${card.text}
            </div>
            <div class="result-item">
              <strong>ç‰Œæ„è§£è¯»ï¼š</strong><br>
              ${card.interpretation}
            </div>
            <div style="margin-top: 15px; font-size: 14px; opacity: 0.8; font-style: italic;">
              ğŸ’« å°†è¿™å¼ ç‰Œçš„æ™ºæ…§èå…¥ä½ çš„ç”Ÿæ´»ï¼Œå®ƒä¼šæˆä¸ºä½ æ—…ç¨‹ä¸­çš„æ˜ç¯ã€‚
            </div>
          `;
        });
        
        singleCardsDiv.appendChild(cardElement);
      });
    }

    // åˆå§‹åŒ–ä¸‰å¼ ç‰Œé˜µæ¨¡å¼
    function initSpreadMode() {
      spreadSelections = { past: null, present: null, future: null };
      spreadCount = 0;
      spreadResultDiv.innerHTML = '';
      
      // ä¸ºæ¯ä¸ªä½ç½®åˆ†é…éšæœºçš„ç‰Œ
      const positions = ['past', 'present', 'future'];
      const cards = getRandomTarotCards(3);
      
      positions.forEach((position, index) => {
        const card = cards[index];
        const cardElement = document.querySelector(`.spread-card[data-position="${position}"]`);
        
        // é‡ç½®çŠ¶æ€
        cardElement.classList.remove('flipped', 'selected');
        cardElement.style.opacity = '1';
        
        const backElement = cardElement.querySelector('.card-back');
        backElement.textContent = card.name;
        backElement.dataset.text = card.text;
        backElement.dataset.interpretation = card.interpretation;
        backElement.dataset.type = card.type;
        
        // è®¾ç½®ç‚¹å‡»äº‹ä»¶
        cardElement.onclick = () => handleSpreadClick(position, cardElement);
      });
    }

    // å¤„ç†ä¸‰å¼ ç‰Œé˜µç‚¹å‡»
    function handleSpreadClick(position, cardElement) {
      if (spreadSelections[position]) return;
      
      const backElement = cardElement.querySelector('.card-back');
      const cardName = backElement.textContent;
      const cardText = backElement.dataset.text;
      const cardInterpretation = backElement.dataset.interpretation;
      const cardType = backElement.dataset.type;
      
      // ç¿»è½¬è¿™å¼ ç‰Œ
      cardElement.classList.add('flipped');
      spreadSelections[position] = { 
        name: cardName, 
        text: cardText,
        interpretation: cardInterpretation,
        type: cardType
      };
      spreadCount++;
      
      // å¦‚æœä¸‰å¼ ç‰Œéƒ½æŠ½å®Œäº†ï¼Œæ˜¾ç¤ºå®Œæ•´è§£è¯»
      if (spreadCount === 3) {
        setTimeout(() => {
          displaySpreadReading();
        }, 500);
      }
    }

    // æ˜¾ç¤ºä¸‰å¼ ç‰Œé˜µçš„å®Œæ•´è§£è¯»
    function displaySpreadReading() {
      const { past, present, future } = spreadSelections;
      const spreadInterpretation = generateSpreadInterpretation(past, present, future);
      
      spreadResultDiv.innerHTML = `
        <div class="result-title">ğŸ”® ä¸‰å¼ ç‰Œé˜µå®Œæ•´è§£è¯»</div>
        <div class="result-item">
          <strong>è¿‡å»ï¼š${past.name}</strong> (${getCardTypeChinese(past.type)})<br>
          ${past.text}<br>
          <em style="font-size: 14px; opacity: 0.8;">${past.interpretation}</em>
        </div>
        <div class="result-item">
          <strong>ç°åœ¨ï¼š${present.name}</strong> (${getCardTypeChinese(present.type)})<br>
          ${present.text}<br>
          <em style="font-size: 14px; opacity: 0.8;">${present.interpretation}</em>
        </div>
        <div class="result-item">
          <strong>æœªæ¥ï¼š${future.name}</strong> (${getCardTypeChinese(future.type)})<br>
          ${future.text}<br>
          <em style="font-size: 14px; opacity: 0.8;">${future.interpretation}</em>
        </div>
        <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
          <strong>æ•´ä½“è§£è¯»ï¼š</strong><br>
          ${spreadInterpretation}
        </div>
      `;
    }

    // ç”Ÿæˆåˆ†äº«å›¾
    function generateShareImage() {
      // éšè—åˆ†äº«å®¹å™¨ï¼ˆå¦‚æœä¹‹å‰æ˜¾ç¤ºï¼‰
      shareImageContainer.style.display = 'none';
      
      // æ¸…ç©ºç”»å¸ƒ
      ctx.clearRect(0, 0, shareCanvas.width, shareCanvas.height);
      
      // è®¾ç½®ç”»å¸ƒèƒŒæ™¯
      const gradient = ctx.createLinearGradient(0, 0, shareCanvas.width, shareCanvas.height);
      gradient.addColorStop(0, '#1b1b2f');
      gradient.addColorStop(1, '#162447');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, shareCanvas.width, shareCanvas.height);
      
      // æ·»åŠ æ ‡é¢˜
      ctx.fillStyle = '#f5c07a';
      ctx.font = 'bold 32px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('ğŸ”® å¡”ç½—ç‰Œå åœç»“æœ', shareCanvas.width / 2, 60);
      
      // æ·»åŠ æ—¶é—´
      const now = new Date();
      const dateStr = `${now.getFullYear()}å¹´${now.getMonth()+1}æœˆ${now.getDate()}æ—¥`;
      ctx.fillStyle = 'rgba(255,255,255,0.8)';
      ctx.font = '18px sans-serif';
      ctx.fillText(dateStr, shareCanvas.width / 2, 100);
      
      // æ ¹æ®å½“å‰æ¨¡å¼æ·»åŠ å†…å®¹
      if (currentMode === 'single' && selectedSingleCardIndex !== -1) {
        // å•å¼ ç‰Œæ¨¡å¼åˆ†äº«å›¾
        const cards = document.querySelectorAll('.single-card');
        const selectedCard = cards[selectedSingleCardIndex];
        const backElement = selectedCard.querySelector('.card-back');
        const cardName = backElement.textContent;
        const cardText = backElement.dataset.text;
        const cardInterpretation = backElement.dataset.interpretation;
        
        // ç»˜åˆ¶ç‰ŒåŒºåŸŸ
        ctx.fillStyle = '#f5c07a';
        ctx.fillRect(shareCanvas.width / 2 - 120, 140, 240, 360);
        
        // ç»˜åˆ¶ç‰Œå†…å®¹
        ctx.fillStyle = '#2b1b0e';
        ctx.font = 'bold 26px sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText(cardName, shareCanvas.width / 2, 220);
        
        // ç»˜åˆ¶è§£é‡Š
        ctx.font = '18px sans-serif';
        const lines = wrapText(ctx, cardText, shareCanvas.width / 2, 280, 200, 28);
        
        // ç»˜åˆ¶åº•éƒ¨æ–‡å­—
        ctx.fillStyle = '#ffffff';
        ctx.font = '16px sans-serif';
        ctx.fillText('å¡”ç½—ç‰Œçš„æ™ºæ…§æŒ‡å¼•ä½ çš„æ—…ç¨‹', shareCanvas.width / 2, 550);
        
        // ç»˜åˆ¶äºŒç»´ç æç¤º
        ctx.fillStyle = 'rgba(255,255,255,0.5)';
        ctx.font = '14px sans-serif';
        ctx.fillText('é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ†äº«', shareCanvas.width / 2, 600);
        
      } else if (currentMode === 'spread' && spreadCount === 3) {
        // ä¸‰å¼ ç‰Œé˜µæ¨¡å¼åˆ†äº«å›¾
        const { past, present, future } = spreadSelections;
        
        // ç»˜åˆ¶ç‰Œé˜µæ ‡é¢˜
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 24px sans-serif';
        ctx.fillText('è¿‡å» / ç°åœ¨ / æœªæ¥', shareCanvas.width / 2, 150);
        
        // ç»˜åˆ¶ä¸‰å¼ ç‰Œ
        const drawCard = (text, x, y, title) => {
          // ç‰ŒèƒŒæ™¯
          ctx.fillStyle = '#f5c07a';
          ctx.fillRect(x - 80, y, 160, 240);
          
          // ç‰Œæ ‡é¢˜
          ctx.fillStyle = '#2b1b0e';
          ctx.font = 'bold 18px sans-serif';
          ctx.fillText(title, x, y + 40);
          
          // ç‰Œå
          ctx.font = '16px sans-serif';
          ctx.fillText(text.name, x, y + 80);
          
          // ç®€ç•¥è§£é‡Š
          const shortText = text.text.length > 12 ? text.text.substring(0, 12) + '...' : text.text;
          ctx.font = '14px sans-serif';
          wrapText(ctx, shortText, x, y + 120, 140, 22);
        };
        
        drawCard(past, shareCanvas.width / 2 - 200, 200, 'è¿‡å»');
        drawCard(present, shareCanvas.width / 2, 200, 'ç°åœ¨');
        drawCard(future, shareCanvas.width / 2 + 200, 200, 'æœªæ¥');
        
        // ç»˜åˆ¶æ•´ä½“è§£è¯»
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 20px sans-serif';
        ctx.fillText('æ—¶é—´çº¿ç´¢çš„å®Œæ•´ç”»é¢', shareCanvas.width / 2, 500);
        
        ctx.font = '16px sans-serif';
        const interpretation = generateSpreadInterpretation(past, present, future);
        const shortInterpretation = interpretation.length > 80 ? interpretation.substring(0, 80) + '...' : interpretation;
        
        wrapText(ctx, shortInterpretation, shareCanvas.width / 2, 540, 500, 25);
        
        // ç»˜åˆ¶åº•éƒ¨æ–‡å­—
        ctx.fillStyle = 'rgba(255,255,255,0.7)';
        ctx.font = '14px sans-serif';
        ctx.fillText('é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ†äº«', shareCanvas.width / 2, 650);
      } else {
        // æ²¡æœ‰æŠ½ç‰Œæ—¶çš„åˆ†äº«å›¾
        ctx.fillStyle = '#ffffff';
        ctx.font = '24px sans-serif';
        ctx.fillText('è¯·å…ˆè¿›è¡Œå¡”ç½—ç‰Œå åœ', shareCanvas.width / 2, 300);
        ctx.font = '18px sans-serif';
        ctx.fillText('é€‰æ‹©å•å¼ ç‰Œæˆ–ä¸‰å¼ ç‰Œé˜µè·å–æŒ‡å¼•', shareCanvas.width / 2, 350);
      }
      
      // æ˜¾ç¤ºåˆ†äº«å›¾å®¹å™¨
      shareImageContainer.style.display = 'block';
    }

    // æ–‡æœ¬æ¢è¡Œå‡½æ•°
    function wrapText(context, text, x, y, maxWidth, lineHeight) {
      const words = text.split('');
      let line = '';
      let lineCount = 0;
      
      for(let n = 0; n < words.length; n++) {
        const testLine = line + words[n];
        const metrics = context.measureText(testLine);
        const testWidth = metrics.width;
        if (testWidth > maxWidth && n > 0) {
          context.fillText(line, x, y);
          line = words[n];
          y += lineHeight;
          lineCount++;
          if (lineCount >= 8) break;
        } else {
          line = testLine;
        }
      }
      context.fillText(line, x, y);
      return lineCount + 1;
    }

    // ä¿å­˜å›¾ç‰‡
    function saveImage() {
      const link = document.createElement('a');
      link.download = `å¡”ç½—ç‰Œå åœ_${new Date().getTime()}.png`;
      link.href = shareCanvas.toDataURL('image/png');
      link.click();
    }

    // äº‹ä»¶ç›‘å¬å™¨
    modeBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        modeBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentMode = btn.dataset.mode;
        
        if (currentMode === 'single') {
          singleModeDiv.style.display = 'block';
          spreadModeDiv.style.display = 'none';
          initSingleMode();
        } else {
          singleModeDiv.style.display = 'none';
          spreadModeDiv.style.display = 'block';
          initSpreadMode();
        }
        
        // éšè—åˆ†äº«å›¾
        shareImageContainer.style.display = 'none';
      });
    });

    resetBtn.addEventListener('click', () => {
      if (currentMode === 'single') {
        initSingleMode();
      } else {
        initSpreadMode();
      }
      
      // éšè—åˆ†äº«å›¾
      shareImageContainer.style.display = 'none';
    });

    shareBtn.addEventListener('click', generateShareImage);
    downloadBtn.addEventListener('click', saveImage);

    // åˆå§‹åŒ–
    initSingleMode();
  </script>
</body>
</html>